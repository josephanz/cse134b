function habit(a,b,c,d,e,f,g,h,i,j,k){this.habitId=a,this.habitName=b,this.iconSource=c,this.freqCount=d,this.freqDay=e,this.freqSet=f,this.freqSetMet=g,this.freqBest=h,this.notificationTime=i,this.freqPerWeek=j,this.parseObject=k,this.updateField=function(a,b,c){updateHabit(this.parseObject,a,b)},this["delete"]=function(){deleteHabit(this.parseObject)}}function getEditItem(){var a=[],b=urlParams.habitId,c=Parse.Object.extend("Habits"),d=new Parse.Query(c);return d.equalTo("user",Parse.User.current()),d.equalTo("objectId",b),d.find({success:function(b){$(".success").show();for(var c=b.length,d=0;c>d;d++){var e=b[d],f=new habit(e.id,e.get("habitName"),e.get("icon").url(),e.get("freqCount"),e.get("freqDay"),e.get("freqSet"),e.get("freqSetMet"),e.get("freqBest"),e.get("notificationTime"),e.get("freqPerWeek"),e);a[d]=f,currentHabit=f,populateHabit(f)}console.log("Successfully retrieved "+a.length)},error:function(a,b){console.log("failed")}}),a}function populateHabit(a){document.getElementById("title").value=a.habitName,document.getElementById("habitIcon").src=a.iconSource,populateWeeklyFreq(a.freqPerWeek),populateFreqPerDay(a.freqSet-1),console.log(a.notificationTime),populateNotificationTime(a.notificationTime)}function populateNotificationTime(a){if(null!==a){var b,c,d,a=a,e=a.split(":"),f=e[0],g=e[1];0==f?(d=0,b=11):f>=1&&12>f?(d=0,b=f-1):12==f?(d=1,b=11):(d=1,b=f-12-1),c=15==g?1:30==g?2:45==g?3:0;var h=document.getElementById("hour"),i=document.getElementById("min"),j=document.getElementById("ampm");h.options[b].selected="true",i.options[c].selected="true",j.options[d].selected="true"}else document.getElementById("myonoffswitch").checked=!1,visible=!1,document.getElementById("time_selector").style.visibility="hidden"}function populateFreqPerDay(a){var b=document.getElementsByName("day");console.log(a);var c=a;b[c].checked=!0}function populateWeeklyFreq(a){for(var b=document.getElementsByName("date"),c=a,d=0;d<b.length;d++)b[d].checked=c[d]}function updateField(a,b,c){a.set(b,c),a.save(null,{success:function(a){}})}function getHabitId(){return urlParams.habitId}function toggle(){var a=document.getElementById("time_selector");visible?(a.style.visibility="hidden",console.log("hi")):(a.style.visibility="visible",console.log("bye")),visible=!visible}function saveIt(){for(var a=document.getElementsByName("date"),b=[],c=!1,d=!1,e=0;e<a.length;e++){a[e].checked?(b[e]=!0,c=!0):b[e]=!1,console.log(b[e]);var f={updated:Parse.User.current().id};Parse.Analytics.track("editPageError",f)}for(var g=document.getElementsByName("day"),h=0,e=0;e<g.length;e++)g[e].checked&&(h=g[e].value,d=!0),console.log(h+" days baby");var i=document.getElementById("hour").value;document.getElementById("ampm").value;"PM"==document.getElementById("ampm").value?12!=i&&(i=1*i+12):12==i&&(i=0);var j=document.getElementById("min").value,k=document.getElementById("title").value,l=i+":"+j;0==document.getElementById("myonoffswitch").checked&&(l=null),console.log(k+" p: "+b+" D: "+h+" t "+l);var m={};(""===k||null===k)&&(m.missingTitle=String(Parse.User.current().id)),c||(m.missingWeeklyFreq=String(Parse.User.current().id)),d||(m.missingDayFreq=String(Parse.User.current().id)),isNotEmpty(m)&&Parse.Analytics.track("editPageError",m),""==k||null==k?alert("please put a habit name"):c?d?addHabit(getHabitId(),k,b,Number(h),l):alert("please select daily frequency"):alert("please select weekly frequency")}function isNotEmpty(a){for(var b in a)if(a.hasOwnProperty(b))return!0;return!1}function isPerWeekFreqChanged(a,b){for(var c=a.length,d=0;c>d;d++)if(a[d]!==b[d])return!0;return!1}function addHabit(a,b,c,d,e){var f=Parse.Object.extend("Habits"),g=new f;g.id=a;var h=createImage();console.log(currentHabit.freqSet+" "+d+" "+currentHabit.freqPerWeek+" "+c),(currentHabit.freqSet!=d||isPerWeekFreqChanged(currentHabit.freqPerWeek,c))&&(g.set("freqCount",0),g.set("freqDay",0),g.set("freqSetMet",0),g.set("freqBest",0)),console.log("image is "+h),g.set("habitName",b),g.set("freqPerWeek",c),g.set("freqSet",d),g.set("notificationTime",e),g.set("icon",h),g.set("user",Parse.User.current()),g.setACL(new Parse.ACL(Parse.User.current())),g.save(null,{success:function(a){$(".success").show(),document.location.href="list.html"},error:function(a,b){$(".error").show()}})}function getIcons(){var a=Parse.Object.extend("Icons"),b=new Parse.Query(a);b.find({success:function(a){$(".success").show();for(var b=a.length,c=0;b>c;c++)icons[c]=a[c];alert("Successfully retrieved "+b)},error:function(a,b){$(".error").show()}})}function setImageForIcon(){imageForIcon=void 0}function createImage(){if(void 0!=imageForIcon){var a=$("#upload")[0];console.log("ddeee"+a);var b=imageForIcon;if(console.log("icon"+b),notAnewFile)return b;var c="photo.jpg",d=new Parse.File(c,b);return d}}function getDefaultImages(){var a=Parse.Object.extend("Icons"),b=new Parse.Query(a);b.find({success:function(a){$(".success").show();for(var b=a.length,c=0;b>c;c++){var d=a[c];images[c]=a[c],console.log("hi"+d.get("icon"))}},error:function(a,b){$(".error").show()}})}function selectImage(a){for(var b=document.getElementsByClassName("icon"),c=0;c<b.length;c++)b[c].style.border="3px inset rgba(0,0,0,0)";console.log(b);var d=document.getElementById(a);switch(d.style.border="3px inset #999999",a){case"icon1":imageForIcon=images[0].get("icon"),notAnewFile=!0;break;case"icon2":imageForIcon=images[1].get("icon"),notAnewFile=!0;break;case"newicon":imageForIcon=imageRecovery,notAnewFile=!1;break;default:imageForIcon=void 0}}function insertImage(a){var b=document.getElementById("testme"),c="onclick=selectImage('newicon') />";b.innerHTML='                   <img id = "newicon"  class="icon" src='+a+" "+c+" "}function imageIsLoaded(a){$("#upload").attr("style","visibility: visibile;"),$("#icon4").attr("style","visiblility: visible;"),$("#icon4").attr("onclick","selectImage('icon4')"),insertImage(a.target.result),$("#icon4").css({border:"3px inset #999999"})}Parse.initialize("M0a7TBns2wo7HMdoULhac86LMnpjPothTzst4a1T","cV4npfDqaSpeTLSwwyhYxg8CvoWqJc0QjXlM37c0");var fields={visited:Parse.User.current().id};console.log("hi track count +1"),Parse.Analytics.track("editPage",fields);var urlParams;(window.onpopstate=function(){var a,b=/\+/g,c=/([^&=]+)=?([^&]*)/g,d=function(a){return decodeURIComponent(a.replace(b," "))},e=window.location.search.substring(1);for(urlParams={};a=c.exec(e);)urlParams[d(a[1])]=d(a[2])})(),void 0===urlParams.habitId&&alert("Warning!!! No Habit Selected");var currentHabit;window.onload=getEditItem();var visible=!0,imageForIcon,imageRecovery;$(function(){$(":file").change(function(){if(this.files&&this.files[0]){var a=new FileReader,b=document.getElementById("upload").files[0].size,c=document.getElementById("upload").files[0].type;b>2048e3?document.getElementById("iconerror").innerHTML="Habit icon file size must not exceed 2mb, size is "+b+" bytes":"image/"!=c.substring(0,6)?document.getElementById("iconerror").innerHTML="Habit icon must be an image file (jpeg, png, bmp, gif, etc.)":(document.getElementById("iconerror").innerHTML="",a.onload=imageIsLoaded,console.log("dyb dyb"+this.files[0]),imageForIcon=this.files[0],imageRecovery=this.files[0],a.readAsDataURL(this.files[0]))}})});var images=[];(window.onpopstate=function(){getDefaultImages()})();var notAnewFile=!1;